<!DOCTYPE html><html><head><meta name="x-poe-datastore-behavior" content="local_only"><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta name="x-poe-datastore-behavior" content="local_only">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <script> window.FontAwesomeConfig = { autoReplaceSvg: 'nest'};</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&amp;display=swap" rel="stylesheet">
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/highcharts-more.js"></script>
    <script src="https://code.highcharts.com/modules/solid-gauge.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <style>
        /* Hide scrollbar for Webkit browsers (Chrome, Safari) */
        ::-webkit-scrollbar {
            display: none;
        }
        /* Hide scrollbar for IE, Edge and Firefox */
        body {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
            font-family: 'Inter', sans-serif;
        }

        /* Ensure content scrolls independently on smaller screens */
        #app-content {
            -webkit-overflow-scrolling: touch; /* Enable smooth scrolling on iOS */
        }

        /* Адаптация для полноэкранного отображения на мобильных устройствах */
        html, body {
            height: 100%; /* Убедитесь, что html и body занимают всю высоту */
            overflow: hidden; /* Предотвращает прокрутку body, если контент внутри scrollable */
        }
        #mobile-app-container {
            height: 100%; /* Контейнер занимает всю высоту своего родителя (body) */
            width: 100%; /* Контейнер занимает всю ширину своего родителя (body) */
            max-width: none !important; /* Убирает ограничение по максимальной ширине */
            max-height: none !important; /* Убирает ограничение по максимальной высоте */
            border-radius: 0 !important; /* Убирает скругление углов для истинного полноэкранного отображения */
            box-shadow: none !important; /* Убирает тень */
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand-dark': '#0D0F13',
                        'brand-gray': '#1A1D23',
                        'brand-light-gray': '#2C313A',
                        'brand-text': '#A6B0C3',
                        'brand-green': '#32D74B',
                        'brand-red': '#FF453A',
                        'brand-blue': '#0A84FF',
                    }
                }
            }
        }
    </script>
<script src="https://puc.poecdn.net/authenticated_preview_page/syncedState.bd4eeeb8e8e02052ee92.js"></script></head>
<body class="bg-black flex justify-center items-center min-h-screen p-0 sm:p-0 md:p-0">
    <!-- Удалены отступы с body для полноэкранного отображения -->
    <div id="mobile-app-container" class="w-full h-full bg-brand-dark overflow-hidden relative flex flex-col mx-auto">
        
        <main id="app-content" class="flex-grow overflow-y-auto pb-24">
            
            <div id="tab-sessions" class="tab-content px-5 pt-12">
                <div id="sessions-header" class="flex justify-between items-center mb-6">
                    <div class="flex items-center space-x-2">
                        <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M16.0002 4.41309C15.148 4.41309 14.3217 4.70014 13.6394 5.21094L6.15137 11.213C5.00049 12.1449 5.31885 13.9785 6.75635 14.428L13.8867 16.6865C15.002 17.0371 16.2412 16.7828 17.1133 16.0337L25.8491 8.78711C26.9995 7.85547 26.6812 6.02148 25.2437 5.57227L18.1133 3.31348C17.4722 3.08464 16.7295 3.16732 16.1035 3.52441C15.938 3.63184 15.7871 3.75879 15.6562 3.89648L11.5586 7.99414L16.0002 11.667L20.4419 7.99414L16.0002 4.41309Z" fill="#32D74B"></path>
                            <path d="M25.2437 27.5869L18.1133 29.8457C17.4722 30.0745 16.7295 29.9918 16.1035 29.6347C15.938 29.5273 15.7871 29.4004 15.6562 29.2627L11.5586 25.165L16.0002 21.4922L20.4419 25.165L25.8491 20.375C26.9995 19.4434 26.6812 17.6094 25.2437 17.1602L18.1133 14.8945C17.4722 14.6657 16.7295 14.7484 16.1035 15.1055C15.938 15.2129 15.7871 15.3398 15.6562 15.4775L6.15137 24.9824C5.00049 26.1328 5.31885 27.9668 6.75635 28.416L13.8867 30.6816C15.002 31.0322 16.2412 30.7779 17.1133 30.0288L25.2437 27.5869Z" fill="#32D74B"></path>
                        </svg>
                        <span class="text-white font-bold text-2xl">luckywave</span>
                    </div>
                    <button id="add-session-btn" class="bg-brand-green/20 text-brand-green w-10 h-10 rounded-full flex items-center justify-center">
                        <i class="fa-solid fa-plus text-lg"></i>
                    </button>
                </div>
                <h1 class="text-white text-3xl font-bold mb-1">My Sessions</h1>
                <p class="text-brand-text mb-8">A log of your recent casino plays.</p>

                <div id="sessions-list" class="space-y-4">
                    <!-- Dynamic sessions will be added here -->
                </div>
            </div>

            <div id="tab-tips" class="tab-content hidden px-5 pt-12">
                <h1 class="text-white text-3xl font-bold mb-2">Pro Player Tips</h1>
                <p class="text-brand-text mb-8">Master the slots with these expert tips.</p>
                <div id="tips-list" class="space-y-4">
                    <div id="tip-1" class="bg-brand-gray p-5 rounded-2xl">
                        <div class="flex items-start space-x-4">
                            <div class="bg-brand-green/20 text-brand-green w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 mt-1">
                                <i class="fa-solid fa-sack-dollar"></i>
                            </div>
                            <div>
                                <h3 class="text-white font-semibold mb-1">Set a Budget</h3>
                                <p class="text-brand-text text-sm leading-relaxed">Always decide on a maximum amount you're willing to lose before you start playing and stick to it. Never chase losses.</p>
                            </div>
                        </div>
                    </div>
                    <div id="tip-2" class="bg-brand-gray p-5 rounded-2xl">
                        <div class="flex items-start space-x-4">
                            <div class="bg-brand-green/20 text-brand-green w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 mt-1">
                                <i class="fa-solid fa-percent"></i>
                            </div>
                            <div>
                                <h3 class="text-white font-semibold mb-1">Check the RTP</h3>
                                <p class="text-brand-text text-sm leading-relaxed">Look for slots with a high Return to Player (RTP) percentage, ideally above 96%. This indicates better long-term payout potential.</p>
                            </div>
                        </div>
                    </div>
                    <div id="tip-3" class="bg-brand-gray p-5 rounded-2xl">
                        <div class="flex items-start space-x-4">
                            <div class="bg-brand-green/20 text-brand-green w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 mt-1">
                                <i class="fa-solid fa-star-half-stroke"></i>
                            </div>
                            <div>
                                <h3 class="text-white font-semibold mb-1">Understand Volatility</h3>
                                <p class="text-brand-text text-sm leading-relaxed">High volatility slots pay out less often but in larger amounts. Low volatility slots offer smaller, more frequent wins. Choose based on your risk tolerance.</p>
                            </div>
                        </div>
                    </div>
                     <div id="tip-4" class="bg-brand-gray p-5 rounded-2xl">
                        <div class="flex items-start space-x-4">
                            <div class="bg-brand-green/20 text-brand-green w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 mt-1">
                                <i class="fa-solid fa-gift"></i>
                            </div>
                            <div>
                                <h3 class="text-white font-semibold mb-1">Utilize Bonuses</h3>
                                <p class="text-brand-text text-sm leading-relaxed">Take advantage of casino bonuses like free spins. They give you extra chances to play and win without risking your own money.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tab-casinos" class="tab-content hidden px-5 pt-12">
                <h1 class="text-white text-3xl font-bold mb-2">Famous Casinos</h1>
                <p class="text-brand-text mb-8">Explore the world's most iconic gaming destinations.</p>
                <div id="casinos-list" class="space-y-6">
                    <div id="casino-1" class="relative rounded-2xl overflow-hidden h-48 flex flex-col justify-end p-4 bg-gradient-to-t from-black/80 to-transparent">
                        <img class="absolute inset-0 w-full h-full object-cover -z-10" src="https://storage.googleapis.com/uxpilot-auth.appspot.com/b0ab898e42-9668e230ac32fbeca833.png" alt="Bellagio Casino Las Vegas at night, vibrant, cinematic">
                        <h3 class="text-white text-xl font-bold">Bellagio</h3>
                        <p class="text-gray-300 text-sm">Las Vegas, USA</p>
                    </div>
                    <div id="casino-2" class="relative rounded-2xl overflow-hidden h-48 flex flex-col justify-end p-4 bg-gradient-to-t from-black/80 to-transparent">
                         <img class="absolute inset-0 w-full h-full object-cover -z-10" src="https://storage.googleapis.com/uxpilot-auth.appspot.com/8752beb954-879b98e408961c276f91.png" alt="Casino de Monte-Carlo exterior, opulent, classic architecture, Monaco">
                        <h3 class="text-white text-xl font-bold">Casino de Monte-Carlo</h3>
                        <p class="text-gray-300 text-sm">Monte Carlo, Monaco</p>
                    </div>
                     <div id="casino-3" class="relative rounded-2xl overflow-hidden h-48 flex flex-col justify-end p-4 bg-gradient-to-t from-black/80 to-transparent">
                         <img class="absolute inset-0 w-full h-full object-cover -z-10" src="https://storage.googleapis.com/uxpilot-auth.appspot.com/ff6d39972b-7a8b1bfaf79a23ed65dd.png" alt="The Venetian Macao exterior, grand canal, gondolas, night time">
                        <h3 class="text-white text-xl font-bold">The Venetian Macao</h3>
                        <p class="text-gray-300 text-sm">Macau, China</p>
                    </div>
                </div>
            </div>

            <div id="tab-analytics" class="tab-content hidden px-5 pt-12">
                 <h1 class="text-white text-3xl font-bold mb-2">Your Analytics</h1>
                <p class="text-brand-text mb-8">An overview of your gaming performance.</p>
                
                <div id="analytics-summary" class="grid grid-cols-2 gap-4 mb-6">
                    <div id="total-winnings-card" class="bg-brand-gray p-4 rounded-2xl">
                        <p class="text-brand-text text-sm mb-1">Total Net Winnings</p>
                        <p id="total-net-winnings" class="text-brand-green text-2xl font-bold">+$0.00</p>
                    </div>
                    <div id="win-rate-card" class="bg-brand-gray p-4 rounded-2xl">
                        <p class="text-brand-text text-sm mb-1">Win Rate</p>
                        <p id="win-rate" class="text-white text-2xl font-bold">0%</p>
                    </div>
                </div>

                <div id="win-loss-chart-container" class="bg-brand-gray p-4 rounded-2xl mb-6">
                     <h3 class="text-white font-semibold mb-4">Win/Loss Over Time</h3>
                     <div id="win-loss-chart" class="h-48"></div>
                </div>
                
                <div id="casino-performance-chart-container" class="bg-brand-gray p-4 rounded-2xl">
                     <h3 class="text-white font-semibold mb-4">Performance by Casino</h3>
                     <div id="casino-performance-chart" class="h-56"></div>
                </div>
            </div>
        </main>

        <nav id="bottom-navigation" class="absolute bottom-0 left-0 right-0 h-24 bg-brand-gray/80 backdrop-blur-xl border-t border-brand-light-gray" style="border-top-left-radius: 20px; border-top-right-radius: 20px;">
            <div class="flex justify-around items-center h-full px-2 pt-2">
                <button data-tab="sessions" class="nav-item flex flex-col items-center space-y-1 text-brand-green">
                    <i class="fa-solid fa-spade text-2xl"></i>
                    <span class="text-xs font-medium">Sessions</span>
                </button>
                <button data-tab="tips" class="nav-item flex flex-col items-center space-y-1 text-brand-text">
                    <i class="fa-solid fa-lightbulb text-2xl"></i>
                    <span class="text-xs font-medium">Tips</span>
                </button>
                <button data-tab="casinos" class="nav-item flex flex-col items-center space-y-1 text-brand-text">
                    <i class="fa-solid fa-landmark text-2xl"></i>
                    <span class="text-xs font-medium">Casinos</span>
                </button>
                <button data-tab="analytics" class="nav-item flex flex-col items-center space-y-1 text-brand-text">
                    <i class="fa-solid fa-chart-pie text-2xl"></i>
                    <span class="text-xs font-medium">Analytics</span>
                </button>
            </div>
        </nav>
        
        <!-- Responsive notch: w-2/5 for relative width -->
        <div id="iphone-notch" class="absolute top-0 left-1/2 -translate-x-1/2 w-2/5 h-7 bg-brand-dark rounded-b-2xl"></div>

        <!-- Session Add Modal -->
        <div id="session-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-75 backdrop-blur-sm">
            <div class="bg-brand-gray p-6 rounded-2xl w-full max-w-sm">
                <h2 class="text-white text-2xl font-bold mb-5">Add New Session</h2>
                
                <div class="mb-4">
                    <label for="modal-amount" class="block text-brand-text text-sm font-medium mb-2">Amount ($)</label>
                    <input type="number" id="modal-amount" class="w-full p-3 rounded-lg bg-brand-dark text-white border border-brand-light-gray focus:outline-none focus:border-brand-green" placeholder="e.g., 250.75 or -50.00" step="0.01">
                </div>

                <div class="mb-4">
                    <label class="block text-brand-text text-sm font-medium mb-2">Result</label>
                    <div class="flex space-x-4">
                        <button id="modal-result-win" class="flex-1 py-2 px-4 rounded-lg bg-brand-dark text-white border border-brand-light-gray focus:outline-none focus:border-brand-green data-[selected=true]:bg-brand-green/20 data-[selected=true]:text-brand-green" data-selected="true">
                            <i class="fa-solid fa-plus-circle mr-2"></i>Win
                        </button>
                        <button id="modal-result-loss" class="flex-1 py-2 px-4 rounded-lg bg-brand-dark text-white border border-brand-light-gray focus:outline-none focus:border-brand-red data-[selected=true]:bg-brand-red/20 data-[selected=true]:text-brand-red" data-selected="false">
                            <i class="fa-solid fa-minus-circle mr-2"></i>Loss
                        </button>
                    </div>
                </div>

                <div class="mb-4">
                    <label for="modal-date" class="block text-brand-text text-sm font-medium mb-2">Date</label>
                    <input type="date" id="modal-date" class="w-full p-3 rounded-lg bg-brand-dark text-white border border-brand-light-gray focus:outline-none focus:border-brand-green">
                </div>

                <div class="mb-4">
                    <label for="modal-casino" class="block text-brand-text text-sm font-medium mb-2">Casino</label>
                    <select id="modal-casino" class="w-full p-3 rounded-lg bg-brand-dark text-white border border-brand-light-gray focus:outline-none focus:border-brand-green">
                        <option value="Bellagio Casino">Bellagio Casino</option>
                        <option value="Caesars Palace">Caesars Palace</option>
                        <option value="MGM Grand">MGM Grand</option>
                        <option value="Aria Resort">Aria Resort</option>
                        <option value="The Palazzo">The Palazzo</option>
                        <option value="Wynn Las Vegas">Wynn Las Vegas</option>
                        <option value="Other">Other...</option>
                    </select>
                    <!-- New custom input field for "Other" casino -->
                    <input type="text" id="modal-other-casino-name" class="w-full p-3 mt-2 rounded-lg bg-brand-dark text-white border border-brand-light-gray focus:outline-none focus:border-brand-green hidden" placeholder="Enter casino name">
                </div>

                <div class="mb-6">
                    <label for="modal-icon" class="block text-brand-text text-sm font-medium mb-2">Icon</label>
                    <div id="modal-icon-selection" class="grid grid-cols-5 gap-2">
                        <button class="icon-option p-2 rounded-lg bg-brand-dark text-brand-text border border-brand-light-gray focus:outline-none focus:border-brand-green data-[selected=true]:bg-brand-green/20 data-[selected=true]:text-brand-green" data-icon="fa-gem"><i class="fa-solid fa-gem"></i></button>
                        <button class="icon-option p-2 rounded-lg bg-brand-dark text-brand-text border border-brand-light-gray focus:outline-none focus:border-brand-green data-[selected=true]:bg-brand-green/20 data-[selected=true]:text-brand-green" data-icon="fa-crown"><i class="fa-solid fa-crown"></i></button>
                        <button class="icon-option p-2 rounded-lg bg-brand-dark text-brand-text border border-brand-light-gray focus:outline-none focus:border-brand-green data-[selected=true]:bg-brand-green/20 data-[selected=true]:text-brand-green" data-icon="fa-star"><i class="fa-solid fa-star"></i></button>
                        <button class="icon-option p-2 rounded-lg bg-brand-dark text-brand-text border border-brand-light-gray focus:outline-none focus:border-brand-green data-[selected=true]:bg-brand-green/20 data-[selected=true]:text-brand-green" data-icon="fa-clover"><i class="fa-solid fa-clover"></i></button>
                        <button class="icon-option p-2 rounded-lg bg-brand-dark text-brand-text border border-brand-light-gray focus:outline-none focus:border-brand-green data-[selected=true]:bg-brand-green/20 data-[selected=true]:text-brand-green" data-icon="fa-dice"><i class="fa-solid fa-dice"></i></button>
                        <button class="icon-option p-2 rounded-lg bg-brand-dark text-brand-text border border-brand-light-gray focus:outline-none focus:border-brand-green data-[selected=true]:bg-brand-green/20 data-[selected=true]:text-brand-green" data-icon="fa-coins"><i class="fa-solid fa-coins"></i></button>
                        <button class="icon-option p-2 rounded-lg bg-brand-dark text-brand-text border border-brand-light-gray focus:outline-none focus:border-brand-green data-[selected=true]:bg-brand-green/20 data-[selected=true]:text-brand-green" data-icon="fa-chart-line"><i class="fa-solid fa-chart-line"></i></button>
                        <button class="icon-option p-2 rounded-lg bg-brand-dark text-brand-text border border-brand-light-gray focus:outline-none focus:border-brand-green data-[selected=true]:bg-brand-green/20 data-[selected=true]:text-brand-green" data-icon="fa-wallet"><i class="fa-solid fa-wallet"></i></button>
                        <button class="icon-option p-2 rounded-lg bg-brand-dark text-brand-text border border-brand-light-gray focus:outline-none focus:border-brand-green data-[selected=true]:bg-brand-green/20 data-[selected=true]:text-brand-green" data-icon="fa-hand-holding-dollar"><i class="fa-solid fa-hand-holding-dollar"></i></button>
                        <button class="icon-option p-2 rounded-lg bg-brand-dark text-brand-text border border-brand-light-gray focus:outline-none focus:border-brand-green data-[selected=true]:bg-brand-green/20 data-[selected=true]:text-brand-green" data-icon="fa-credit-card"><i class="fa-solid fa-credit-card"></i></button>
                    </div>
                </div>

                <div class="flex justify-end space-x-4">
                    <button id="modal-cancel-btn" class="py-2 px-5 rounded-lg bg-brand-light-gray text-white font-medium">Cancel</button>
                    <button id="modal-save-btn" class="py-2 px-5 rounded-lg bg-brand-blue text-white font-medium">Save Session</button>
                </div>
            </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const navItems = document.querySelectorAll('.nav-item');
            const tabContents = document.querySelectorAll('.tab-content');
            const sessionsList = document.getElementById('sessions-list');
            const addSessionBtn = document.getElementById('add-session-btn');
            const totalNetWinningsElement = document.getElementById('total-net-winnings');
            const winRateElement = document.getElementById('win-rate');

            const sessionModal = document.getElementById('session-modal');
            const modalAmountInput = document.getElementById('modal-amount');
            const modalResultWinBtn = document.getElementById('modal-result-win');
            const modalResultLossBtn = document.getElementById('modal-result-loss');
            const modalDateInput = document.getElementById('modal-date');
            const modalCasinoSelect = document.getElementById('modal-casino');
            const modalOtherCasinoNameInput = document.getElementById('modal-other-casino-name'); // New: Custom casino input
            const modalIconSelection = document.getElementById('modal-icon-selection');
            const modalCancelBtn = document.getElementById('modal-cancel-btn');
            const modalSaveBtn = document.getElementById('modal-save-btn');

            let sessionData = []; // Store session data to update analytics
            let winLossChart;
            let casinoPerformanceChart;
            let selectedResultType = 'win'; // 'win' or 'loss'
            let selectedIcon = 'fa-gem'; // Default icon

            // Initial sessions data
            const initialSessions = [
                { id: 1, casino: "Bellagio Casino", date: "Oct 15, 2025", net: 250.75, icon: "fa-gem" },
                { id: 2, casino: "Caesars Palace", date: "Oct 12, 2025", net: -120.00, icon: "fa-crown" },
                { id: 3, casino: "MGM Grand", date: "Oct 10, 2025", net: 85.50, icon: "fa-star" },
                { id: 4, casino: "Aria Resort", date: "Oct 05, 2025", net: -50.25, icon: "fa-clover" },
            ];

            function renderSession(session) {
                const sessionElement = document.createElement('div');
                sessionElement.id = `session-${session.id}`;
                sessionElement.className = 'bg-brand-gray p-4 rounded-2xl flex items-center justify-between';
                sessionElement.innerHTML = `
                    <div class="flex items-center space-x-4">
                        <div class="bg-brand-light-gray w-12 h-12 rounded-lg flex items-center justify-center">
                            <i class="fa-solid ${session.icon} text-brand-green text-2xl"></i>
                        </div>
                        <div>
                            <p class="text-white font-semibold">${session.casino}</p>
                            <p class="text-brand-text text-sm">${session.date}</p>
                        </div>
                    </div>
                    <div class="text-right">
                         <p class="${session.net >= 0 ? 'text-brand-green' : 'text-brand-red'} font-bold text-lg">
                            ${session.net >= 0 ? '+$' : '-$'} ${Math.abs(session.net).toFixed(2)}
                         </p>
                         <p class="text-brand-text text-sm">${session.net >= 0 ? 'Net Win' : 'Net Loss'}</p>
                    </div>
                `;
                sessionsList.prepend(sessionElement); // Add to the top
            }

            function loadInitialSessions() {
                sessionData = [...initialSessions];
                // Render in reverse order so the latest are on top when using prepend
                sessionData.slice().reverse().forEach(session => renderSession(session));
                updateAnalyticsSummary();
                // Charts will be rendered on first analytics tab view
            }

            // --- Modal Logic ---
            function showModal() {
                sessionModal.classList.remove('hidden');
                // Reset form fields
                modalAmountInput.value = '';
                // Set default date to today
                modalDateInput.valueAsDate = new Date(); 
                modalCasinoSelect.value = 'Bellagio Casino';
                modalOtherCasinoNameInput.value = ''; // Reset custom input
                modalOtherCasinoNameInput.classList.add('hidden'); // Hide custom input by default
                
                // Reset result type to Win and icon to gem
                selectResultType('win');
                selectIcon('fa-gem');
            }

            function hideModal() {
                sessionModal.classList.add('hidden');
            }

            function selectResultType(type) {
                selectedResultType = type;
                modalResultWinBtn.dataset.selected = (type === 'win');
                modalResultLossBtn.dataset.selected = (type === 'loss');
            }

            function selectIcon(iconClass) {
                selectedIcon = iconClass;
                document.querySelectorAll('.icon-option').forEach(btn => {
                    btn.dataset.selected = (btn.dataset.icon === iconClass);
                });
            }

            addSessionBtn.addEventListener('click', showModal);
            modalCancelBtn.addEventListener('click', hideModal);
            modalResultWinBtn.addEventListener('click', () => selectResultType('win'));
            modalResultLossBtn.addEventListener('click', () => selectResultType('loss'));
            modalIconSelection.addEventListener('click', (event) => {
                const target = event.target.closest('.icon-option');
                if (target) {
                    selectIcon(target.dataset.icon);
                }
            });

            // New: Event listener for casino select dropdown to show/hide custom input
            modalCasinoSelect.addEventListener('change', function() {
                if (this.value === 'Other') {
                    modalOtherCasinoNameInput.classList.remove('hidden');
                    modalOtherCasinoNameInput.focus(); // Focus on the new input
                } else {
                    modalOtherCasinoNameInput.classList.add('hidden');
                }
            });

            modalSaveBtn.addEventListener('click', () => {
                const amount = parseFloat(modalAmountInput.value);
                const date = modalDateInput.value; // YYYY-MM-DD
                let casino = modalCasinoSelect.value;

                // If "Other" is selected, use the custom input's value
                if (casino === 'Other') {
                    casino = modalOtherCasinoNameInput.value.trim();
                    if (!casino) { // Validate if custom casino name is provided
                        alert('Please enter a casino name for "Other".');
                        return;
                    }
                }

                if (isNaN(amount) || !date || !casino) {
                    alert('Please fill in all session details.');
                    return;
                }

                const netAmount = selectedResultType === 'win' ? Math.abs(amount) : -Math.abs(amount);
                
                // Format date for display (e.g., "Oct 15, 2025")
                const dateObj = new Date(date);
                const formattedDate = dateObj.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });

                const newSession = {
                    id: sessionData.length + 1,
                    casino: casino,
                    date: formattedDate,
                    net: netAmount,
                    icon: selectedIcon
                };
                
                sessionData.push(newSession);
                renderSession(newSession); // Add to UI
                updateAnalyticsSummary(); // Recalculate totals
                
                // Re-render charts
                if (winLossChart) winLossChart.destroy(); 
                if (casinoPerformanceChart) casinoPerformanceChart.destroy(); 
                renderAnalyticsCharts(); 

                hideModal(); // Close modal
            });
            // --- End Modal Logic ---


            function switchTab(tabName) {
                tabContents.forEach(content => {
                    if (content.id === `tab-${tabName}`) {
                        content.classList.remove('hidden');
                    } else {
                        content.classList.add('hidden');
                    }
                });

                navItems.forEach(item => {
                    if (item.dataset.tab === tabName) {
                        item.classList.remove('text-brand-text');
                        item.classList.add('text-brand-green');
                    } else {
                        item.classList.remove('text-brand-green');
                        item.classList.add('text-brand-text');
                    }
                });
                
                if (tabName === 'analytics') {
                    // This check ensures charts are only rendered once or if data changes/they are destroyed.
                    // Highcharts.chart returns the chart object, so checking for its existence is fine.
                    // Also checking if it's already 'rendered' into a DOM element.
                    if (!winLossChart || winLossChart.renderTo.id !== 'win-loss-chart' || !casinoPerformanceChart || casinoPerformanceChart.renderTo.id !== 'casino-performance-chart') {
                        renderAnalyticsCharts(); 
                    } else {
                        // If charts already exist, ensure they reflow if the container size changed
                        winLossChart.reflow();
                        casinoPerformanceChart.reflow();
                    }
                }
            }
            
            navItems.forEach(item => {
                item.addEventListener('click', () => {
                    const tabName = item.dataset.tab;
                    switchTab(tabName);
                });
            });

            function updateAnalyticsSummary() {
                const totalNet = sessionData.reduce((sum, session) => sum + session.net, 0);
                const totalWins = sessionData.filter(session => session.net >= 0).length;
                const totalSessions = sessionData.length;
                const winRate = totalSessions > 0 ? (totalWins / totalSessions * 100).toFixed(0) : 0;

                totalNetWinningsElement.textContent = `${totalNet >= 0 ? '+$' : '-$'}${Math.abs(totalNet).toFixed(2)}`;
                totalNetWinningsElement.classList.toggle('text-brand-green', totalNet >= 0);
                totalNetWinningsElement.classList.toggle('text-brand-red', totalNet < 0);
                winRateElement.textContent = `${winRate}%`;
            }

            function renderAnalyticsCharts() {
                // Highcharts struggles with rendering in hidden elements.
                // Ensure chart containers are momentarily visible if the analytics tab is active.
                // This approach ensures they are drawn correctly.
                const analyticsTab = document.getElementById('tab-analytics');
                const isAnalyticsTabActive = !analyticsTab.classList.contains('hidden');

                if (!isAnalyticsTabActive) {
                    // Temporarily make it visible if not active to allow Highcharts to render correctly
                    analyticsTab.style.visibility = 'hidden';
                    analyticsTab.classList.remove('hidden');
                }


                // Prepare data for charts, sorting by date for time-series chart
                const sortedSessionData = [...sessionData].sort((a, b) => {
                    // Parse "Oct 15, 2025" into Date objects for comparison
                    const dateA = new Date(a.date.replace(/(\w{3})\s(\d{1,2}),\s(\d{4})/, '$1 $2 $3'));
                    const dateB = new Date(b.date.replace(/(\w{3})\s(\d{1,2}),\s(\d{4})/, '$1 $2 $3'));
                    return dateA - dateB;
                });
                const categories = sortedSessionData.map(s => s.date);
                const netResults = sortedSessionData.map(s => s.net);

                const casinoPerformance = sortedSessionData.reduce((acc, session) => {
                    acc[session.casino] = (acc[session.casino] || 0) + session.net;
                    return acc;
                }, {});

                const casinoNames = Object.keys(casinoPerformance);
                const casinoNetValues = casinoNames.map(name => ({
                    name: name, // Ensure name is passed for tooltip
                    y: casinoPerformance[name],
                    color: casinoPerformance[name] >= 0 ? '#32D74B' : '#FF453A'
                }));

                // Win/Loss Chart
                winLossChart = Highcharts.chart('win-loss-chart', {
                    chart: {
                        type: 'area',
                        backgroundColor: 'transparent',
                        style: { fontFamily: 'Inter' }
                    },
                    title: { text: null },
                    credits: { enabled: false },
                    xAxis: {
                        categories: categories,
                        labels: { style: { color: '#A6B0C3' } },
                        lineColor: '#2C313A',
                        tickColor: '#2C313A'
                    },
                    yAxis: {
                        title: { text: null },
                        labels: { 
                            style: { color: '#A6B0C3' },
                            format: '${value}'
                        },
                        gridLineColor: '#1A1D23'
                    },
                    legend: { enabled: false },
                    tooltip: {
                        backgroundColor: '#0D0F13',
                        borderColor: '#2C313A',
                        style: { color: '#FFFFFF' },
                        formatter: function () {
                            return `<b>${this.x}</b><br/>Net: <b>$${this.y.toFixed(2)}</b>`;
                        }
                    },
                    plotOptions: {
                        area: {
                            marker: {
                                enabled: true,
                                symbol: 'circle',
                                radius: 4,
                                states: { hover: { enabled: true } }
                            }
                        }
                    },
                    series: [{
                        name: 'Net Result',
                        data: netResults,
                        color: '#32D74B', // Green for positive
                        negativeColor: '#FF453A', // Red for negative
                        fillColor: {
                            linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 },
                            stops: [
                                [0, Highcharts.color('#32D74B').setOpacity(0.5).get('rgba')],
                                [1, Highcharts.color('#32D74B').setOpacity(0).get('rgba')]
                            ]
                        },
                         negativeFillColor: {
                            linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 },
                            stops: [
                                [0, Highcharts.color('#FF453A').setOpacity(0.5).get('rgba')],
                                [1, Highcharts.color('#FF453A').setOpacity(0).get('rgba')]
                            ]
                        }
                    }]
                });

                // Casino Performance Chart
                casinoPerformanceChart = Highcharts.chart('casino-performance-chart', {
                    chart: {
                        type: 'bar',
                        backgroundColor: 'transparent',
                        style: { fontFamily: 'Inter' }
                    },
                    title: { text: null },
                    credits: { enabled: false },
                    xAxis: {
                        categories: casinoNames,
                        labels: { style: { color: '#A6B0C3' } },
                        lineColor: '#2C313A'
                    },
                    yAxis: {
                        title: { text: null },
                        labels: { style: { color: '#A6B0C3' }, format: '${value}' },
                        gridLineColor: '#1A1D23'
                    },
                    legend: { enabled: false },
                    tooltip: {
                        backgroundColor: '#0D0F13',
                        borderColor: '#2C313A',
                        style: { color: '#FFFFFF' },
                        formatter: function () {
                            return `<b>${this.key}</b><br/>Net: <b>$${this.y.toFixed(2)}</b>`;
                        }
                    },
                    plotOptions: {
                        bar: {
                            borderRadius: 4,
                            borderWidth: 0
                        }
                    },
                    series: [{
                        name: 'Net Winnings by Casino',
                        data: casinoNetValues
                    }]
                });

                if (!isAnalyticsTabActive) {
                    // Hide it again if it was originally hidden
                    analyticsTab.classList.add('hidden');
                    analyticsTab.style.visibility = ''; // Reset visibility
                }
            }

            // Initial state: load sessions and show 'Sessions' tab by default
            loadInitialSessions();
            switchTab('sessions');
        });
    </script>


</body></html>